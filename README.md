
# Smartscan AI

## General information

This Github-project can be used to train a reinforcement learning agent, in order to make pointclouds smoother. It does this by moving the points in the pointcloud around, and getting the average difference between all normals.

## Project structure

The project consists of three parts.

### Data Augmentation

Data augmentation is responsible for generating a large dataset from only a few initial pointclouds. It does this by moving around the points in the initial pointclouds or adding more points to them.

### Preprocessing

Preprocessing prepares all the pointclouds created in the previous step for training. The reinforcement learning algorithm that is being used does not allow for dynamic test sizing. Therefore we mold all pointclouds to be of a certain adjustable size.

### Learning

The reinforcement learning is done by the [stable-baselines3](https://stable-baselines3.readthedocs.io/en/master/) library. The library has been implemented and the reinforcement learning agent can move all the points in the pointclouds around. The reward function is as follows:

* Positive feedback if the pointcloud is smoother. (This is calculated by taking the average angle difference between the normal of a points and its neighbours, summed up for all points)
* Negative feedback for the distance a point is moved away from its original position. This is to prevent the model from moving all points into a single point or a ball, since those shapes are the smoothest.

## Classes

In this section the purpose and most important functions of the classes are explained.

### [main.py](https://github.com/hanno00/SmartscanAI/blob/main/main.py)

This file runs the entire project and has all the options available for tweaking. All the options are explained below:



### [Augmentation.py](https://github.com/hanno00/SmartscanAI/blob/main/Augmentation.py)

The Augmentation class is intended to enlarge the dataset. By loading a csv or ply file, the points of the point clouds can be moved. In addition, points can be added. These are generated at an arbitrary distance (variable) from the original points.

### [Preprocessing.py](https://github.com/hanno00/SmartscanAI/blob/main/Preprocessing.py)

The Preprocessing class is intended to get the point clouds to the desired number of points. The desired number of points is variable, but must always remain the same within a training session.

### [PcdController.py](https://github.com/hanno00/SmartscanAI/blob/main/PcdController.py)

This is a static class which can be used to make all kind of changes to a pointcloud. Most of them directly use the [open3d](http://www.open3d.org/) library to do these changes. The cost that is being used in the reinforcement learning also gets computed here.

### [FootEnvironment.py](https://github.com/hanno00/SmartscanAI/blob/main/FootEnvironment.py)

This class houses the environment in which the Reinforcment Learning Agent works. This class is responsible for providing the agent with pointclouds, apply its actions, calculating the effectiveness of the actions and providing that feedback to the agent. This class randomly selects the next pointcloud (.ply files generated by the preprocessing step) from its source folder, but optionally the next pointcloud can be provided as an argument in the reset function. For the environment, its important that the size of the pointclouds matches the size expected by the class (default 3500).
